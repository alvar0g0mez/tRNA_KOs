"0","# Average DE results across the 3 plates"
"0","## Grab the responsiveness dataframes for each plate"
"0","resp_01 <- DE_01[[4]]"
"0","resp_02 <- DE_02[[4]]"
"0","resp_03 <- DE_03[[4]]"
"0",""
"0","## Rename columns so that the dataframes can be merged"
"0","colnames(resp_01)[colnames(resp_01) == ""nDEP""] <- ""nDEP_01"""
"0","colnames(resp_02)[colnames(resp_02) == ""nDEP""] <- ""nDEP_02"""
"0","colnames(resp_03)[colnames(resp_03) == ""nDEP""] <- ""nDEP_03"""
"0",""
"0","## Merge"
"0","resp_full <- full_join(resp_01, resp_02, by = c(""Strain.Name"", ""Replicate_num"", ""AA"", ""chromosome"", ""anticodon""))"
"0","resp_full <- full_join(resp_full, resp_03, by = c(""Strain.Name"", ""Replicate_num"", ""AA"", ""chromosome"", ""anticodon"")) %>%"
"0","  select(""Strain.Name"", ""Replicate_num"", ""AA"", ""chromosome"", ""anticodon"", ""nDEP_01"", ""nDEP_02"", ""nDEP_03"")"
"0",""
"0","## Check how many NAs per plate (so how many tRNA_KO strains were not present in that plate)"
"0","sum(is.na(resp_full$nDEP_01))               # 1"
"1","[1]"
"1"," 1"
"1","
"
"0","sum(is.na(resp_full$nDEP_02))               # 56 - I am removing the whole wrong batch (how many samples were there in there actually?)"
"1","[1]"
"1"," 56"
"1","
"
"0","sum(is.na(resp_full$nDEP_03))               # 18"
"1","[1]"
"1"," 18"
"1","
"
"0","## Check how many 0s (0 nDEP) per plate - honestly no idea why this is so different between batches"
"0","sum(resp_full$nDEP_01 == 0, na.rm = T)      # 101"
"1","[1]"
"1"," 101"
"1","
"
"0","sum(resp_full$nDEP_02 == 0, na.rm = T)      # 78"
"1","[1]"
"1"," 78"
"1","
"
"0","sum(resp_full$nDEP_03 == 0, na.rm = T)      # 44"
"1","[1]"
"1"," 44"
"1","
"
"0","## Take the mean of nDEP across the 3 plates - keep only those tRNAs for which I have a number (not NA) in at least 2 of the plates"
"0","resp_filtered <- resp_full %>%"
"0","  mutate(filter_column = case_when(is.na(nDEP_01)+is.na(nDEP_02)+is.na(nDEP_03) > 1 ~ 0,"
"0","                                   TRUE ~ 1)) %>%"
"0","  filter(filter_column == 1) %>%"
"0","  select(-filter_column)"
"0",""
"0","resp_filtered <- resp_filtered %>%"
"0","  mutate(avg_nDEP = rowMeans(select(resp_filtered, c(""nDEP_01"", ""nDEP_02"", ""nDEP_03"")), na.rm = T)) "
"0",""
"0",""
"0","# Remove unnecessary variables"
"0","rm(resp_01, resp_02, resp_03, resp_full, trna_ko_01, trna_ko_02, trna_ko_03, trna_controls)"
