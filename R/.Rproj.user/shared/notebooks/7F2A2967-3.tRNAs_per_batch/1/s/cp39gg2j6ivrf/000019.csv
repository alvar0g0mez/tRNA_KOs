"0","# Load their phenotypic data: growth rate and growth yield for all KOs"
"0","phenotypic_data <- as.data.frame(fread('C:/MyStuff/tRNAs/Data/bloom_ackermann_2014/phenotypic_results.tsv'))"
"0",""
"0","# Just number of DE proteins"
"0","UCU_major_minor <- phenotypic_data %>% "
"0","  filter(UCU_family != ""No"") %>%"
"0","  select(gene_name, UCU_family) %>%"
"0","  rename(Strain.Name = gene_name)"
"0",""
"0","UCU_resp_filtered <- resp_filtered %>% filter(anticodon == ""UCU"")"
"0",""
"0","UCU_family <- full_join(UCU_major_minor, UCU_resp_filtered, by = ""Strain.Name"")"
"0",""
"0",""
"0","# Volcano plots"
"0","## Keep only KOs in UCU family"
"0","KOs_in_UCU_family <- UCU_family$Strain.Name"
"0","da_only_KOs_from_UCU_family <- da_full[da_full$Strain.Name %in% KOs_in_UCU_family,]"
"0",""
"0","## Come up with the list of plots"
"0","plot_list <- list()"
"0","for (i in 1:length(KOs_in_UCU_family)) {"
"0","  trna <- KOs_in_UCU_family[i]"
"0","  plot_title <- paste(trna, UCU_family$UCU_family[UCU_family$Strain.Name == trna], sep = ""_"")"
"0","  temp <- da_only_KOs_from_UCU_family %>% filter(Strain.Name == trna)"
"0","  plot_list[[i]] <- ggplot(data = temp, aes(x = logFC, y = -log10(adj.P.Val), col = diffexpressed)) +"
"0","    geom_point() +"
"0","    geom_hline(yintercept = -log10(alpha), linetype = ""dashed"", col = ""gray"") +"
"0","    geom_vline(xintercept = c(-1.5, 1.5), linetype = ""dashed"", col = ""gray"") +"
"0","    theme_light() +"
"0","    theme(legend.position = ""none"") +"
"0","    labs(title = plot_title) +"
"0","    scale_color_manual(values = c(Down_regulated = ""#80AAFF"", Not_significant = ""#808080"", Up_regulated = ""#FF8080""))"
"0","}"
"0",""
"0","## List of ggplot objects has to be turned to list of grobs for grid.arrange to work"
"0","my_grobs <- lapply(plot_list, ggplotGrob)"
"2","Aviso: [38;5;255mRemoved 3575 rows containing missing values or values outside the scale range (`geom_point()`).[39m"
"2","Aviso: [38;5;255mRemoved 3575 rows containing missing values or values outside the scale range (`geom_point()`).[39m"
"2","Aviso: [38;5;255mRemoved 3575 rows containing missing values or values outside the scale range (`geom_point()`).[39m"
"2","Aviso: [38;5;255mRemoved 3575 rows containing missing values or values outside the scale range (`geom_point()`).[39m"
"2","Aviso: [38;5;255mRemoved 3575 rows containing missing values or values outside the scale range (`geom_point()`).[39m"
"0","## Print to PDF"
"0","ggsave("
"0","   filename = ""C:/MyStuff/tRNAs/Output/Plots/Volcano_plots/volcano_plots_per_KO_UCU_family.pdf"", "
"0","   plot = marrangeGrob(my_grobs, nrow=4, ncol=4), "
"0","   width = 15, height = 9"
"0",")"
