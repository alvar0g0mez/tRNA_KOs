"0","microarray_samples <- colnames(microarray_data[2:6])"
"0",""
"0","da_for_microarray_samples <- da_full %>% filter(Strain.Name %in% microarray_samples)"
"0",""
"0","for (i in 1:length(microarray_samples)) {"
"0","  sample <- microarray_samples[i]"
"0","  da_temp <- da_full %>% "
"0","    filter(Strain.Name == sample) %>%"
"0","    select(protein, diffexpressed, logFC, adj.P.Val)"
"0","  colnames(da_temp) <- c(""Gene.symbol"", ""diffexpressed"", ""logFC"", ""adj.P.Val"")"
"0","  microarray_temp <- microarray_data %>% select(all_of(sample), Gene.symbol)"
"0","  test <- left_join(microarray_temp, da_temp, by = ""Gene.symbol"")"
"0","  test <- inner_join(da_temp, microarray_temp, by = ""Gene.symbol"")"
"0","  test <- test %>% mutate(diffexpressed = case_when(diffexpressed == ""Up_regulated"" ~ ""Up_regulated"","
"0","                                                    diffexpressed == ""Down_regulated"" ~ ""Down_regulated"","
"0","                                                    TRUE ~ ""Not_significant""))"
"0","  colnames(test) <- c(""Gene.symbol"", ""diffexpressed"", ""logFC"", ""adj.P.Val"", ""logfold_microarray"")"
"0","  "
"0","  "
"0","  # Calculate correlation to add to plot"
"0","  corr_coef <- round(cor(test$logFC, test$logfold_microarray, method = ""spearman"", use = ""complete.obs""), 2)"
"0","  "
"0","  "
"0","  # Protein names in X axis, transcriptomics fold change in Y axis, color by significance in proteomics - not such a good plot tbh"
"0","  "
"0","  #p1 <- ggplot(data = test, aes(x = Gene.symbol, y = as.numeric(logfold_microarray), col = diffexpressed)) +"
"0","  #  geom_point() +"
"0","  #  labs(title = sample,"
"0","  #       col = ""Differentially\nexpressed\nin proteomics\ndata"") +"
"0","  #  xlab(""Protein name"") +"
"0","  #  ylab(""Transcriptomics fold change"") +"
"0","  #  theme(axis.text.x=element_blank(),"
"0","  #      axis.ticks.x=element_blank()) +"
"0","  #  geom_text(data = subset(test, diffexpressed == ""Up_regulated"" | diffexpressed == ""Down_regulated""),"
"0","  #            aes(x = Gene.symbol, y = as.numeric(logfold_microarray), col = diffexpressed, label = Gene.symbol),"
"0","  #            size = 5)"
"0","  #print(p1)"
"0","  "
"0","  "
"0","  # logFC transcriptomics vs. logFC proteomics - color by significance in proteomics: much better"
"0","  p2 <- ggplot(data = test, aes(x = logFC, y = logfold_microarray, col = diffexpressed)) +"
"0","    geom_point(size = 1.5) +"
"0","    labs(title = glue('{sample} - correlation coef. = {corr_coef}'),"
"0","         col = ""Differentially\nexpressed\nin proteomics\ndata"") +"
"0","    xlab(""logFC proteomics"") +"
"0","    ylab(""logFC transcriptomics"") +"
"0","    theme_light() +"
"0","    geom_text_repel(data = subset(test, diffexpressed == ""Up_regulated"" | diffexpressed == ""Down_regulated""),"
"0","              aes(x = logFC, y = logfold_microarray, col = diffexpressed, label = Gene.symbol),"
"0","              size = 4) +"
"0","    geom_abline() +"
"0","    scale_color_manual(values = c(Down_regulated = ""#80AAFF"", Not_significant = ""#808080"", Up_regulated = ""#FF8080""))"
"0","  print(p2)"
"0","  "
"0","  # This is just to check if the FCs from the microarrays data are also log2FCs, which I think so but their article says only FC"
"0","  #hist(test$logfold_microarray)"
"0","  #hist(test$logFC)"
"0","  #hist((test$logFC)^2)"
"0","}"
"0",""
