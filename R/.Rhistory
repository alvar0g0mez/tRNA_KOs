de_proteins_list_005 <- de_proteins_list_005[names(de_proteins_list_005) != "WT"]
# Synthetase information
chu_synths <- as.data.frame(fread(paste(base_dir, "Data/Other/Articles/chu_2011/S3.csv", sep="")))[1:20,]
# Yeastmine
yeastmine <- as.data.frame(fread(paste(base_dir, "Data/alliancemine_results_2024-11-20T11-19-04.tsv", sep="")))
# Before I match standard to systematic names, I need to extend the rows with multiple standard names into several rows, each with one of the systematic names, since they are all meaningful and different
chu_synths_new <- data.frame(matrix(ncol = ncol(chu_synths), nrow = 0))
colnames(chu_synths_new) <- colnames(chu_synths)
for (i in 1:nrow(chu_synths)) {
std_name <- chu_synths$Synthetase[i]
if (grepl("/", std_name)) {
std_names <- str_split_1(std_name, "/")
for (j in 1:length(std_names)) {
new_row <- chu_synths[i, ]
new_row$Synthetase[1] <- std_names[j]
chu_synths_new <- rbind(chu_synths_new, new_row)
}
}
else {
new_row <- chu_synths[i,]
chu_synths_new <- rbind(chu_synths_new, new_row)
}
}
chu_synths_new <- chu_synths_new %>%
rename(gene_names = Synthetase)
# Get a column with systematic gene names in the synthetase dataframe (they only have the standard naming)
chu_synths_new <- match_systematic_and_standard_protein_names(data = chu_synths_new,
yeastmine = yeastmine,
input = "standard",
simplify = F,
add_extra_columns = F)
# Load YeastMine dataset
yeastmine <- as.data.frame(fread(paste(base_dir, "Data/alliancemine_results_2024-11-20T11-19-04.tsv", sep="")))
# Subset this into a new dataframe with only info of tRNA synthases/synthetases (remove "kinase" because there is one that says "tRNA synthase-associated kinase")
synthetases <- yeastmine[(grepl("trna synthase", yeastmine$Gene.name, ignore.case = T)|grepl("trna synthetase", yeastmine$Gene.name, ignore.case = T)) &
!grepl("kinase", yeastmine$Gene.name, ignore.case = T),]
# How many tRNA synthases
sum(grepl("trna synthase", synthetases$Gene.name, ignore.case = T))
# How many tRNA synthetases
sum(grepl("trna synthetase", synthetases$Gene.name, ignore.case = T))
# How many of these are mitochondrial and how many nuclear? Is this overlapping?
sum(grepl("mitochondrial", synthetases$Gene.name, ignore.case = T))
# Add a column with information on:
#   - Whether each synthetase is mitochondrial or not
#   - Whether it is a synthase or a synthetase
#   - Whether it is the actual enzyme or a cofactor
synthetases <- synthetases %>%
mutate(mitochondrial = case_when(grepl("mitochondrial", Gene.name, ignore.case = T) ~ "Yes",
TRUE ~ "No"),
type = case_when(grepl("synthase", Gene.name, ignore.case = T) ~ "synthase",
grepl("synthetase", Gene.name, ignore.case = T) ~ "synthetase"),
cofactor_or_enzyme = case_when(grepl("cofactor", Gene.name, ignore.case = T) ~ "cofactor",
TRUE ~ "enzyme"))
# Merge this with the k_cat and other synthetase info from van der Haar et al., 2008
check <- left_join(synthetases, chu_synths_new, by = "Gene.secondaryIdentifier") %>%
dplyr::select(-Gene.briefDescription)
# Save this final version of the synthetase data to use it later
fwrite(synthetases, paste(base_dir, "Data/trna_synthetases.csv", sep=""))
# Get all the proteins we detect into systematic notation
detected_proteins <- match_systematic_and_standard_protein_names(data = rownames(trna_ko),
yeastmine = yeastmine,
input = "standard",
simplify = T)
# See how many tRNA synthetases are in there: 18, 67% of them
sum(detected_proteins %in% synthetases$Gene.secondaryIdentifier)
sum(detected_proteins %in% synthetases$Gene.secondaryIdentifier)/length(unique(synthetases$Gene.secondaryIdentifier))
# Check which ones: only 1 is mitochondrial, all others are cytosolic - so I think we are mainly interested in cytosolic, we detect 17 of the 18 there are, the one we don't detect is YPL040C
synths_detected <- synthetases[synthetases$Gene.secondaryIdentifier %in% detected_proteins,]
sum(synths_detected$mitochondrial == "Yes")
sum(synthetases$mitochondrial == "No")
temp <- synthetases$Gene.secondaryIdentifier[synthetases$mitochondrial == "No"]
synthetases$Gene.secondaryIdentifier[!(synthetases$Gene.secondaryIdentifier %in% synths_detected$Gene.secondaryIdentifier) & (synthetases$mitochondrial == "No")]
de_synthetases_001 <- list()
for (i in 1:length(de_proteins_list_001)) {
de_proteins <- de_proteins_list_001[[i]]
temp <- de_proteins[de_proteins %in% chu_synths_new$Gene.secondaryIdentifier]
if (length(temp) > 0) {
de_synthetases_001[[names(de_proteins_list_001)[i]]] <- temp
}
}
# Get a table summarizing this
temp <- unlist(de_synthetases_001)
sort(table(temp))
# Remove unnecessary variables
rm(de_proteins, temp)
de_synthetases_005 <- list()
for (i in 1:length(de_proteins_list_005)) {
de_proteins <- de_proteins_list_005[[i]]
temp <- de_proteins[de_proteins %in% chu_synths_new$Gene.secondaryIdentifier]
if (length(temp) > 0) {
de_synthetases_005[[names(de_proteins_list_005)[i]]] <- temp
}
}
# Get a table summarizing this
temp <- unlist(de_synthetases_005)
sort(table(temp))
# Remove unnecessary variables
rm(de_proteins, temp)
grab_de_synthetases_dfs <- function(da_full, de_synthetases, yeastmine) {
de_synthetases_dfs <- list()
for (i in 1:length(da_full)) {
strain_name <- names(da_full)[[i]]
strains_with_de_synths <- names(de_synthetases)
if (strain_name %in% strains_with_de_synths) {
temp <- da_full[[i]]
rownames(temp) <- match_systematic_and_standard_protein_names(data = rownames(temp),
yeastmine = yeastmine,
input = "standard",
simplify = T)
temp <- temp[rownames(temp) %in% de_synthetases[[strain_name]],]
temp$Synthetase <- rownames(temp)
temp$Strain.Name <- strain_name
de_synthetases_dfs[[strain_name]] <- temp
}
}
# Turn the resulting list into a single dataframe
de_synthetases_df <- bind_rows(de_synthetases_dfs)
rownames(de_synthetases_df) <- NULL
# Add a column with the standard names for the tRNA synthetase genes
temp <- match_systematic_and_standard_protein_names(data = as.character(de_synthetases_df$Synthetase),
yeastmine = yeastmine,
input = "systematic",
simplify = T)
de_synthetases_df$Synthetase_standard <- temp
de_synthetases_df <- de_synthetases_df %>%
rename(Synthetase_systematic = Synthetase)
return(de_synthetases_df)
}
da <- read_json(path=paste(base_dir, "Data/Other/enrichment_analysis/da.json", sep=""), simplifyVector = T)
de_synthetases_df_001 <- grab_de_synthetases_dfs(da, de_synthetases_001, yeastmine)
de_synthetases_df_005 <- grab_de_synthetases_dfs(da, de_synthetases_005, yeastmine)
add_2_columns <- function(de_synthetases_df) {
# Amino acid carried by the KOd tRNA
temp <- master_dataset %>%
dplyr::select(Strain.Name, Isotype_from_anticodon_1_letter)
de_synthetases_df <- left_join(de_synthetases_df, temp, by = "Strain.Name") %>%
rename(AA = Isotype_from_anticodon_1_letter)
temp <- amino_acids %>%
dplyr::select(AA, amino_acid_charge, amino_acid_type) %>%
rename(AA_charge_tRNA = amino_acid_charge,
AA_type_tRNA = amino_acid_type)
de_synthetases_df <- left_join(de_synthetases_df, temp, by = "AA") %>%
rename(AA_carried_by_tRNA = AA)
# Amino acid loaded by the synthetase
temp <- amino_acids %>%
dplyr::select(Amino_acid, AA, amino_acid_charge, amino_acid_type) %>%
rename(AA_loaded_by_synthetase = AA,
AA_charge_synth = amino_acid_charge,
AA_type_synth = amino_acid_type)
temp_2 <- left_join(chu_synths_new, temp, by = "Amino_acid") %>%
dplyr::select(Gene.secondaryIdentifier, AA_charge_synth, AA_type_synth) %>%
rename(Synthetase = Gene.secondaryIdentifier)
temp_3 <- temp_2 %>%
group_by(Synthetase) %>%
summarise(text=paste(AA_charge_synth, collapse = ",")) %>%
rename(AA_charge_synth = text,
Synthetase_systematic = Synthetase)
temp_4 <- temp_2 %>%
group_by(Synthetase) %>%
summarise(text=paste(AA_type_synth, collapse = ",")) %>%
rename(AA_type_synth = text,
Synthetase_systematic = Synthetase)
de_synthetases_df <- left_join(de_synthetases_df, temp_3, by = "Synthetase_systematic")
de_synthetases_df <- left_join(de_synthetases_df, temp_4, by = "Synthetase_systematic")
temp <- left_join(chu_synths_new, temp, by = "Amino_acid") %>%
dplyr::select(Gene.secondaryIdentifier, AA_loaded_by_synthetase) %>%
rename(Synthetase = Gene.secondaryIdentifier) %>%
group_by(Synthetase) %>%
summarise(text=paste(AA_loaded_by_synthetase, collapse = ",")) %>%
rename(AA_loaded_by_synthetase = text,
Synthetase_systematic = Synthetase)
de_synthetases_df <- left_join(de_synthetases_df, temp, by = "Synthetase_systematic") %>%
rename()
return(de_synthetases_df)
}
amino_acids <- as.data.frame(fread(paste(base_dir, "Data/Other/GtRNAdb/amino_acids.csv", sep=""))) %>%
rename(Amino_acid = X3_letter_code,
AA = X1_letter_code)
de_synthetases_df_001 <- add_2_columns(de_synthetases_df_001)
View(master_dataset)
add_2_columns <- function(de_synthetases_df) {
# Amino acid carried by the KOd tRNA
temp <- master_dataset %>%
dplyr::select(gene_name, Isotype_from_anticodon_1_letter)
de_synthetases_df <- left_join(de_synthetases_df, temp, by = "Strain.Name") %>%
rename(AA = Isotype_from_anticodon_1_letter)
temp <- amino_acids %>%
dplyr::select(AA, amino_acid_charge, amino_acid_type) %>%
rename(AA_charge_tRNA = amino_acid_charge,
AA_type_tRNA = amino_acid_type)
de_synthetases_df <- left_join(de_synthetases_df, temp, by = "AA") %>%
rename(AA_carried_by_tRNA = AA)
# Amino acid loaded by the synthetase
temp <- amino_acids %>%
dplyr::select(Amino_acid, AA, amino_acid_charge, amino_acid_type) %>%
rename(AA_loaded_by_synthetase = AA,
AA_charge_synth = amino_acid_charge,
AA_type_synth = amino_acid_type)
temp_2 <- left_join(chu_synths_new, temp, by = "Amino_acid") %>%
dplyr::select(Gene.secondaryIdentifier, AA_charge_synth, AA_type_synth) %>%
rename(Synthetase = Gene.secondaryIdentifier)
temp_3 <- temp_2 %>%
group_by(Synthetase) %>%
summarise(text=paste(AA_charge_synth, collapse = ",")) %>%
rename(AA_charge_synth = text,
Synthetase_systematic = Synthetase)
temp_4 <- temp_2 %>%
group_by(Synthetase) %>%
summarise(text=paste(AA_type_synth, collapse = ",")) %>%
rename(AA_type_synth = text,
Synthetase_systematic = Synthetase)
de_synthetases_df <- left_join(de_synthetases_df, temp_3, by = "Synthetase_systematic")
de_synthetases_df <- left_join(de_synthetases_df, temp_4, by = "Synthetase_systematic")
temp <- left_join(chu_synths_new, temp, by = "Amino_acid") %>%
dplyr::select(Gene.secondaryIdentifier, AA_loaded_by_synthetase) %>%
rename(Synthetase = Gene.secondaryIdentifier) %>%
group_by(Synthetase) %>%
summarise(text=paste(AA_loaded_by_synthetase, collapse = ",")) %>%
rename(AA_loaded_by_synthetase = text,
Synthetase_systematic = Synthetase)
de_synthetases_df <- left_join(de_synthetases_df, temp, by = "Synthetase_systematic") %>%
rename()
return(de_synthetases_df)
}
amino_acids <- as.data.frame(fread(paste(base_dir, "Data/Other/GtRNAdb/amino_acids.csv", sep=""))) %>%
rename(Amino_acid = X3_letter_code,
AA = X1_letter_code)
de_synthetases_df_001 <- add_2_columns(de_synthetases_df_001)
View(de_synthetases_df_001)
add_2_columns <- function(de_synthetases_df) {
# Amino acid carried by the KOd tRNA
temp <- master_dataset %>%
rename(Strain.Name = gene_name) %>%
dplyr::select(Strain.Name, Isotype_from_anticodon_1_letter)
de_synthetases_df <- left_join(de_synthetases_df, temp, by = "Strain.Name") %>%
rename(AA = Isotype_from_anticodon_1_letter)
temp <- amino_acids %>%
dplyr::select(AA, amino_acid_charge, amino_acid_type) %>%
rename(AA_charge_tRNA = amino_acid_charge,
AA_type_tRNA = amino_acid_type)
de_synthetases_df <- left_join(de_synthetases_df, temp, by = "AA") %>%
rename(AA_carried_by_tRNA = AA)
# Amino acid loaded by the synthetase
temp <- amino_acids %>%
dplyr::select(Amino_acid, AA, amino_acid_charge, amino_acid_type) %>%
rename(AA_loaded_by_synthetase = AA,
AA_charge_synth = amino_acid_charge,
AA_type_synth = amino_acid_type)
temp_2 <- left_join(chu_synths_new, temp, by = "Amino_acid") %>%
dplyr::select(Gene.secondaryIdentifier, AA_charge_synth, AA_type_synth) %>%
rename(Synthetase = Gene.secondaryIdentifier)
temp_3 <- temp_2 %>%
group_by(Synthetase) %>%
summarise(text=paste(AA_charge_synth, collapse = ",")) %>%
rename(AA_charge_synth = text,
Synthetase_systematic = Synthetase)
temp_4 <- temp_2 %>%
group_by(Synthetase) %>%
summarise(text=paste(AA_type_synth, collapse = ",")) %>%
rename(AA_type_synth = text,
Synthetase_systematic = Synthetase)
de_synthetases_df <- left_join(de_synthetases_df, temp_3, by = "Synthetase_systematic")
de_synthetases_df <- left_join(de_synthetases_df, temp_4, by = "Synthetase_systematic")
temp <- left_join(chu_synths_new, temp, by = "Amino_acid") %>%
dplyr::select(Gene.secondaryIdentifier, AA_loaded_by_synthetase) %>%
rename(Synthetase = Gene.secondaryIdentifier) %>%
group_by(Synthetase) %>%
summarise(text=paste(AA_loaded_by_synthetase, collapse = ",")) %>%
rename(AA_loaded_by_synthetase = text,
Synthetase_systematic = Synthetase)
de_synthetases_df <- left_join(de_synthetases_df, temp, by = "Synthetase_systematic") %>%
rename()
return(de_synthetases_df)
}
amino_acids <- as.data.frame(fread(paste(base_dir, "Data/Other/GtRNAdb/amino_acids.csv", sep=""))) %>%
rename(Amino_acid = X3_letter_code,
AA = X1_letter_code)
de_synthetases_df_001 <- add_2_columns(de_synthetases_df_001)
de_synthetases_df_005 <- add_2_columns(de_synthetases_df_005)
# Remove unnecessary variables
rm(chu_synths, chu_synths_new, de_proteins_list_001, de_proteins_list_005, new_row, trna_ko, yeastmine,
std_name, std_names, i, j, synthetases, check, detected_proteins, temp, de_synthetases_001, de_synthetases_005,
grab_de_synthetases_dfs, da, amino_acids, add_2_columns)
# Remove unnecessary variables
rm(chu_synths, chu_synths_new, de_proteins_list_001, de_proteins_list_005, new_row, trna_ko, yeastmine,
std_name, std_names, i, j, synthetases, check, detected_proteins, de_synthetases_001, de_synthetases_005,
grab_de_synthetases_dfs, da, amino_acids, add_2_columns, synths_detected)
View(proteomics_raw)
if (working_from == "charite") {
ts_library <- as.data.frame(fread("C:/MyStuff/TSSC/Data/Growth/Mine/Processed_by_them/growth_agar_matched.tsv"))
} else if (working_from == "home") {
ts_library <- as.data.frame(fread("/home/alvaro/MyStuff/TSSC/Data/Growth/Mine/Processed_by_them/growth_agar_matched.tsv"))
}
if (working_from == "charite") {
ts_library <- as.data.frame(fread("C:/MyStuff/TSSc/Data/Growth/Mine/Processed_by_them/growth_agar_matched.tsv"))
} else if (working_from == "home") {
ts_library <- as.data.frame(fread("/home/alvaro/MyStuff/TSSc/Data/Growth/Mine/Processed_by_them/growth_agar_matched.tsv"))
}
View(ts_library)
# Processed KO proteomics dataframe
trna_ko <- as.data.frame(as.matrix(fread(paste(base_dir, "Data/Other/proteomics_data/processed_proteomics_dataframe.tsv", sep="")), rownames = 1))
# List of dataframes with the proteins that were DE in each KO strain - at alpha = 0.01
de_proteins_list_001 <- fromJSON(paste(base_dir, "Data/Other/enrichment_analysis/de_proteins_list_001.json", sep=""))
## Remove WT dataframe
de_proteins_list_001 <- de_proteins_list_001[names(de_proteins_list_001) != "WT"]
# List of dataframes with the proteins that were DE in each KO strain - at alpha = 0.05
de_proteins_list_005 <- fromJSON(paste(base_dir, "Data/Other/enrichment_analysis/de_proteins_list_005.json", sep=""))
## Remove WT dataframe
de_proteins_list_005 <- de_proteins_list_005[names(de_proteins_list_005) != "WT"]
# Synthetase information
chu_synths <- as.data.frame(fread(paste(base_dir, "Data/Other/Articles/chu_2011/S3.csv", sep="")))[1:20,]
# Yeastmine
yeastmine <- as.data.frame(fread(paste(base_dir, "Data/alliancemine_results_2024-11-20T11-19-04.tsv", sep="")))
# Before I match standard to systematic names, I need to extend the rows with multiple standard names into several rows, each with one of the systematic names, since they are all meaningful and different
chu_synths_new <- data.frame(matrix(ncol = ncol(chu_synths), nrow = 0))
colnames(chu_synths_new) <- colnames(chu_synths)
for (i in 1:nrow(chu_synths)) {
std_name <- chu_synths$Synthetase[i]
if (grepl("/", std_name)) {
std_names <- str_split_1(std_name, "/")
for (j in 1:length(std_names)) {
new_row <- chu_synths[i, ]
new_row$Synthetase[1] <- std_names[j]
chu_synths_new <- rbind(chu_synths_new, new_row)
}
}
else {
new_row <- chu_synths[i,]
chu_synths_new <- rbind(chu_synths_new, new_row)
}
}
chu_synths_new <- chu_synths_new %>%
rename(gene_names = Synthetase)
# Get a column with systematic gene names in the synthetase dataframe (they only have the standard naming)
chu_synths_new <- match_systematic_and_standard_protein_names(data = chu_synths_new,
yeastmine = yeastmine,
input = "standard",
simplify = F,
add_extra_columns = F)
# Load YeastMine dataset
yeastmine <- as.data.frame(fread(paste(base_dir, "Data/alliancemine_results_2024-11-20T11-19-04.tsv", sep="")))
# Subset this into a new dataframe with only info of tRNA synthases/synthetases (remove "kinase" because there is one that says "tRNA synthase-associated kinase")
synthetases <- yeastmine[(grepl("trna synthase", yeastmine$Gene.name, ignore.case = T)|grepl("trna synthetase", yeastmine$Gene.name, ignore.case = T)) &
!grepl("kinase", yeastmine$Gene.name, ignore.case = T),]
# How many tRNA synthases
sum(grepl("trna synthase", synthetases$Gene.name, ignore.case = T))
# How many tRNA synthetases
sum(grepl("trna synthetase", synthetases$Gene.name, ignore.case = T))
# How many of these are mitochondrial and how many nuclear? Is this overlapping?
sum(grepl("mitochondrial", synthetases$Gene.name, ignore.case = T))
# Add a column with information on:
#   - Whether each synthetase is mitochondrial or not
#   - Whether it is a synthase or a synthetase
#   - Whether it is the actual enzyme or a cofactor
synthetases <- synthetases %>%
mutate(mitochondrial = case_when(grepl("mitochondrial", Gene.name, ignore.case = T) ~ "Yes",
TRUE ~ "No"),
type = case_when(grepl("synthase", Gene.name, ignore.case = T) ~ "synthase",
grepl("synthetase", Gene.name, ignore.case = T) ~ "synthetase"),
cofactor_or_enzyme = case_when(grepl("cofactor", Gene.name, ignore.case = T) ~ "cofactor",
TRUE ~ "enzyme"))
# Merge this with the k_cat and other synthetase info from van der Haar et al., 2008
check <- left_join(synthetases, chu_synths_new, by = "Gene.secondaryIdentifier") %>%
dplyr::select(-Gene.briefDescription)
# Save this final version of the synthetase data to use it later
fwrite(synthetases, paste(base_dir, "Data/trna_synthetases.csv", sep=""))
# Get all the proteins we detect into systematic notation
detected_proteins <- match_systematic_and_standard_protein_names(data = rownames(trna_ko),
yeastmine = yeastmine,
input = "standard",
simplify = T)
# See how many tRNA synthetases are in there: 18, 67% of them
sum(detected_proteins %in% synthetases$Gene.secondaryIdentifier)
sum(detected_proteins %in% synthetases$Gene.secondaryIdentifier)/length(unique(synthetases$Gene.secondaryIdentifier))
# Check which ones: only 1 is mitochondrial, all others are cytosolic - so I think we are mainly interested in cytosolic, we detect 17 of the 18 there are, the one we don't detect is YPL040C
synths_detected <- synthetases[synthetases$Gene.secondaryIdentifier %in% detected_proteins,]
sum(synths_detected$mitochondrial == "Yes")
sum(synthetases$mitochondrial == "No")
temp <- synthetases$Gene.secondaryIdentifier[synthetases$mitochondrial == "No"]
synthetases$Gene.secondaryIdentifier[!(synthetases$Gene.secondaryIdentifier %in% synths_detected$Gene.secondaryIdentifier) & (synthetases$mitochondrial == "No")]
de_synthetases_001 <- list()
for (i in 1:length(de_proteins_list_001)) {
de_proteins <- de_proteins_list_001[[i]]
temp <- de_proteins[de_proteins %in% chu_synths_new$Gene.secondaryIdentifier]
if (length(temp) > 0) {
de_synthetases_001[[names(de_proteins_list_001)[i]]] <- temp
}
}
# Get a table summarizing this
temp <- unlist(de_synthetases_001)
sort(table(temp))
# Remove unnecessary variables
rm(de_proteins, temp)
de_synthetases_005 <- list()
for (i in 1:length(de_proteins_list_005)) {
de_proteins <- de_proteins_list_005[[i]]
temp <- de_proteins[de_proteins %in% chu_synths_new$Gene.secondaryIdentifier]
if (length(temp) > 0) {
de_synthetases_005[[names(de_proteins_list_005)[i]]] <- temp
}
}
# Get a table summarizing this
temp <- unlist(de_synthetases_005)
sort(table(temp))
# Remove unnecessary variables
rm(de_proteins, temp)
grab_de_synthetases_dfs <- function(da_full, de_synthetases, yeastmine) {
de_synthetases_dfs <- list()
for (i in 1:length(da_full)) {
strain_name <- names(da_full)[[i]]
strains_with_de_synths <- names(de_synthetases)
if (strain_name %in% strains_with_de_synths) {
temp <- da_full[[i]]
rownames(temp) <- match_systematic_and_standard_protein_names(data = rownames(temp),
yeastmine = yeastmine,
input = "standard",
simplify = T)
temp <- temp[rownames(temp) %in% de_synthetases[[strain_name]],]
temp$Synthetase <- rownames(temp)
temp$Strain.Name <- strain_name
de_synthetases_dfs[[strain_name]] <- temp
}
}
# Turn the resulting list into a single dataframe
de_synthetases_df <- bind_rows(de_synthetases_dfs)
rownames(de_synthetases_df) <- NULL
# Add a column with the standard names for the tRNA synthetase genes
temp <- match_systematic_and_standard_protein_names(data = as.character(de_synthetases_df$Synthetase),
yeastmine = yeastmine,
input = "systematic",
simplify = T)
de_synthetases_df$Synthetase_standard <- temp
de_synthetases_df <- de_synthetases_df %>%
rename(Synthetase_systematic = Synthetase)
return(de_synthetases_df)
}
da <- read_json(path=paste(base_dir, "Data/Other/enrichment_analysis/da.json", sep=""), simplifyVector = T)
de_synthetases_df_001 <- grab_de_synthetases_dfs(da, de_synthetases_001, yeastmine)
de_synthetases_df_005 <- grab_de_synthetases_dfs(da, de_synthetases_005, yeastmine)
add_2_columns <- function(de_synthetases_df) {
# Amino acid carried by the KOd tRNA
temp <- master_dataset %>%
rename(Strain.Name = gene_name) %>%
dplyr::select(Strain.Name, Isotype_from_anticodon_1_letter)
de_synthetases_df <- left_join(de_synthetases_df, temp, by = "Strain.Name") %>%
rename(AA = Isotype_from_anticodon_1_letter)
temp <- amino_acids %>%
dplyr::select(AA, amino_acid_charge, amino_acid_type) %>%
rename(AA_charge_tRNA = amino_acid_charge,
AA_type_tRNA = amino_acid_type)
de_synthetases_df <- left_join(de_synthetases_df, temp, by = "AA") %>%
rename(AA_carried_by_tRNA = AA)
# Amino acid loaded by the synthetase
temp <- amino_acids %>%
dplyr::select(Amino_acid, AA, amino_acid_charge, amino_acid_type) %>%
rename(AA_loaded_by_synthetase = AA,
AA_charge_synth = amino_acid_charge,
AA_type_synth = amino_acid_type)
temp_2 <- left_join(chu_synths_new, temp, by = "Amino_acid") %>%
dplyr::select(Gene.secondaryIdentifier, AA_charge_synth, AA_type_synth) %>%
rename(Synthetase = Gene.secondaryIdentifier)
temp_3 <- temp_2 %>%
group_by(Synthetase) %>%
summarise(text=paste(AA_charge_synth, collapse = ",")) %>%
rename(AA_charge_synth = text,
Synthetase_systematic = Synthetase)
temp_4 <- temp_2 %>%
group_by(Synthetase) %>%
summarise(text=paste(AA_type_synth, collapse = ",")) %>%
rename(AA_type_synth = text,
Synthetase_systematic = Synthetase)
de_synthetases_df <- left_join(de_synthetases_df, temp_3, by = "Synthetase_systematic")
de_synthetases_df <- left_join(de_synthetases_df, temp_4, by = "Synthetase_systematic")
temp <- left_join(chu_synths_new, temp, by = "Amino_acid") %>%
dplyr::select(Gene.secondaryIdentifier, AA_loaded_by_synthetase) %>%
rename(Synthetase = Gene.secondaryIdentifier) %>%
group_by(Synthetase) %>%
summarise(text=paste(AA_loaded_by_synthetase, collapse = ",")) %>%
rename(AA_loaded_by_synthetase = text,
Synthetase_systematic = Synthetase)
de_synthetases_df <- left_join(de_synthetases_df, temp, by = "Synthetase_systematic") %>%
rename()
return(de_synthetases_df)
}
amino_acids <- as.data.frame(fread(paste(base_dir, "Data/Other/GtRNAdb/amino_acids.csv", sep=""))) %>%
rename(Amino_acid = X3_letter_code,
AA = X1_letter_code)
de_synthetases_df_001 <- add_2_columns(de_synthetases_df_001)
de_synthetases_df_005 <- add_2_columns(de_synthetases_df_005)
# Remove unnecessary variables
rm(chu_synths, chu_synths_new, de_proteins_list_001, de_proteins_list_005, new_row, trna_ko, yeastmine,
std_name, std_names, i, j, check, detected_proteins, de_synthetases_001, de_synthetases_005,
grab_de_synthetases_dfs, da, amino_acids, add_2_columns, synths_detected)
View(synthetases)
synths_in_ts_library <- ts_library[ts_library$Systematic_name %in% synthetases$Gene.secondaryIdentifier]
synths_in_ts_library <- ts_library[ts_library$Systematic_name %in% synthetases$Gene.secondaryIdentifier,]
View(synths_in_ts_library)
View(de_synthetases_df_001)
View(synthetases)
synths_in_ts_library_info <- synthetases[synthetases$Gene.secondaryIdentifier %in% ts_library$Systematic_name]
synths_in_ts_library_info <- synthetases[synthetases$Gene.secondaryIdentifier %in% ts_library$Systematic_name,]
View(synths_in_ts_library)
View(synths_in_ts_library_info)
# Save them
fwrite(de_synthetases_df_001, paste(base_dir, "Data/Other/synthetases/de_synthetases_df_001.tsv"))
# Save them
fwrite(de_synthetases_df_001, paste(base_dir, "Data/Other/synthetases/de_synthetases_df_001.tsv", sep=""))
fwrite(de_synthetases_df_005, paste(base_dir, "Data/Other/synthetases/de_synthetases_df_005.tsv", sep=""))
# Remove everything
rm(de_synthetases_001, de_synthetases_005, ts_library, synths_in_ts_library_info, ts_library_synths)
rm(synths_in_ts_library)
rm(synthetases)
